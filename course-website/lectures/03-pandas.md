# 3. Pandas

데이터과학을 할 때 가장 많이 사용하는 언어가 파이썬과 R입니다. 2010년도 쯤에 데이터과학이 유명해지기 시작할 때만 해도 R에서 제공하던 함수 및 라이브러리가 파이썬보다 더 많았습니다. R에서 사용하던 여러가지 기능들을 파이썬에서 제공하기 시작한게 Pandas 라이브러리 부터라고 볼 수 있습니다. 그래서 파이썬에서 데이터과학을 하는데 Pandas는 필수적인 라이브러리입니다. 

Pandas는 2008년에 Wes McKinney의 개인 프로젝트로 시작했습니다. Wes는 미국 동부에서 금융업에 종사하면서 파이썬을 활용해 금융 데이터 분석을 하고 있었습니다. R에서는 그 당시 여러가지 기능들을 제공 했지만 느리다는 단점이 있었고, 파이썬은 R보다는 빠르지만 다양한 기능을 제공하는 오픈 소스 라이브러리가 없었습니다. 그래서 본인이 사용하기 위해서 개인 프로젝트로 Pandas를 만들기 시작했습니다. Pandas에 기능이 하나 둘씩 추가되면서 다른 사람들도 많이 사용하기 시작했으며 본인 회사 내에서 먼저 유명하게 됐습니다. 그리고 나서 회사를 설득해서 Pandas를 오픈 소스로 출시하게 됩니다. 지금은 Pandas를 쓰지 않는 데이터 과학자가 없다고 해도 무방할 정도로 많은 사람이 사용하는 라이브러리가 됐습니다. 

금융쪽에서는 테이블 형태의 정형데이터를 패널 데이터(panel data)라고 칭합니다. Panel data를 줄여서 Pandas로 이름을 지었다고 하다가, 후일담으로 판다가 귀엽기 때문에 그냥 Pandas라고 했다라는 얘기를 하기도 했습니다. Pandas가 지원하는 기능으로는 데이터 입출력, 변환, 선택, 결합, 전처리, 그룹핑 등이 있습니다. 

## 3.1 Pandas 설치

Pandas는 Anaconda Navigator 또는 터미널을 통해 설치할 수 있습니다. Anaconda Navigator로 설치하는 방법은 Environments 탭에 가서 설치를 원하는 가상환경을 선택 후 Pandas 라이브러리 옆에 체크 박스를 선택하면 설치가 됩니다. 터미널을 통해서 설치하는 방법은 먼저 터미널에서 Pandas를 설치할려고 하는 가상환경을 `conda activate [가상환경 이름]` 명령어를 통해 실행 후 `pip install pandas`를 통해 설치 가능합니다. 라이브러리를 사용하다가 새 버전이 나와서 업그레이드를 해야 한다면 터미널에서 `pip install -U pandas`명령어를 통해 업그레이드 할 수 있습니다. 해당 명령어는 기존에 pandas가 없는 경우 pandas를 최신 버전으로 설치해주며 pandas가 있는 경우에는 최신 버전으로 업그레이드 해줍니다. 

```{note}
pip은 파이썬에서 사용하는 패키지 관리 프로그램입니다. pip을 통해 다양한 라이브러리를 다운로드 받고 관리할 수 있습니다. 
```

## 3.2 Pandas 객체

Pandas에서는 데이터프레임과 시리즈라는 객체를 지원합니다. 데이터프레임은 R에서 넘어온 개념이며 테이블 형식으로 된 데이터를 뜻합니다. 반면 시리즈는 1차원적인 벡터 형식으로 된 데이터를 뜻합니다. 예를 들어 표 3.X는 인덱스가 있고 두 개의 열이 있습니다. 첫번째 열은 u라는 열이고 두번째 열은 g라는 열입니다. 또한 첫번째 행은 count라는 행이며 두번째 행은 mean이라는 행입니다. 이처럼 2차원적인 데이터를 저장할 때 Pandas에서는 데이터프레임이라는 객체를 사용합니다. 

데이터프레임에서 하나의 컬럼만 뽑아낸다면 그것은 1차원 데이터가 될 것이며 이것을 시리즈라고 합니다. 시리즈는 인덱스 값이 원소 값과 같이 저장됩니다. 인덱스는 별도로 명시하지 않으면 0부터 시작을 합니다. 그림 3.X에 dtype이라고 하는 것은 데이터 타입을 뜻합니다. 데이터 타입은 정수형, 실수형, 시간형, 문자열 등이 있는데 3.3절에서 자세히 다뤄보도록 하겠습니다. 

Pandas 객체는 여러개의 member function을 보유하고 있습니다. 예를 들어 df라는 데이터프레임이 존재할 때 df.head() 함수를 사용하면 데이터프레임의 상위 5개의 행을 출력해줍니다. 각 함수들에 대한 설명은 아래와 같으며 실습 단계에서 자세히 다뤄 보겠습니다. 

- `head()`, `tail()`: 데이터프레임 또는 시리즈의 상위, 하위 5개의 행을 출력합니다. 
- `[]`, `iloc[]`, `loc[]`: 행 또는 열을 선택할 때 사용합니다. 
- `apply()`: 행/열에 특정 함수를 적용할 때 사용합니다. 
- `groupby()`: 특정 열로 그룹핑을 할 때 사용합니다. 
- `sort_values()`, `sort_index()`: 특정 열 또는 인덱스의 값으로 정렬할 때 사용합니다. 
- `drop()`, `drop_duplicates()`: 행/열을 삭제할 때 사용합니다. 
- `shape`: 행과 열의 크기를 반환합니다. 
- `count()`: 특정 행/열에 몇 개의 값이 존재하는지 계산합니다. 
- `sum()`: 특정 행/열의 총 합을 반환합니다. 
- `cumsum()`: 누적 합을 반환합니다. 
- `mean()`: 평균값을 반환합니다. 
- `median()`: 중앙값을 반환합니다. 
- `min()`: 최솟값을 반환합니다. 
- `max()`: 최댓값을 반환합니다. 
- `std()`: 표준편차를 반환합니다. 
- `var()`: 분산을 반환합니다. 
- `sample()`: 특정 개수 또는 퍼센트 만큼의 표본을 추출해서 반환합니다.   
- `unique()`: 해당 열에 존재하는 고유값을 반환합니다. 
- `nunique()`: 해당 열에 존재하는 고유값의 개수를 반환합니다. 
- `value_counts()`: 각 고유값별 개수를 반환합니다. 
- `set_index()`: 인덱스를 새로 지정할 때 사용합니다. 
- `reset_index()`: 인덱스를 초기화 시키고 기존 인덱스를 컬럼으로 변환하고자 할 때 사용합니다. 

## 3.3 Pandas 데이터 타입

Pandas에서 제공하는 주요 데이터 타입은 아래와 같습니다. 


데이터 타입 | 설명 | 
---------|----------|
 Int64, float64 | 64비트 정수/실수 | 
 bool | True/False | 
 object | 문자열 포함 임의의 데이터 타입 | 
 datetime64[ns] | 날짜/시간 | 
 timedelta64[ns] | 날짜/시간 차이 | 
 astype() | 데이터 타입 변환 시 사용 | 
 pandas.to_datetime() | 문자를 날짜/시간으로 변환
- 표 3.X

또한 pandas에는 NaN 데이터 타입이 존재하는데 Not a Number의 약자로써 결측값을 뜻합니다. NaN을 처리하는 주요 함수는 아래와 같습니다. 

함수 | 설명 | 
---------|----------|
 isnull() | NaN이 있는지 여부 확인 (T/F) | 
 dropna() | NaN이 있는 행/열 삭제 | 
 fillna() | NaN이 있는 행/열 대치 |  
- 표 3.X

## 3.4 Pandas 함수

이 외에도 주로 사용 되는 함수는 아래와 같습니다. 

함수 | 설명 | 
---------|----------|
 read_csv(), write_csv() | CSV 파일 입출력 | 
 merge(), concat() | 서로 다른 DataFrame 결합 | 
 hist(), plot() | 데이터 히스토그램/시각화 | 
 dt.day/weekday/month/year/weekofyear | Datetime[ns] 타입 데이터의 일/요일/월/년/주 | 
 resample() | Datetime[ns] 타입 데이터 리샘플링| 
 pivot_table() | 피봇테이블 생성 | 
 corr() | 상관관계 계산 | 

## 3.5 Jupyter Notebook 실행 및 확장팩 설치

Pandas 실습을 하기 위해 Jupyter Notebook을 먼저 실행하겠습니다. Jupyter Notebook을 실행하는 방법은 2.2.4절을 참고 바랍니다.  

Jupyter Notebook에는 다양한 확장팩을 지원하는데, 확장팩을 설치하는 방법은 터미널에서 `conda install -c conda-forge jupyter_contrib_nbextensions`를 입력하면 됩니다. 

확장팩 설치가 완료되면 Jupyter Notebook 메인 화면에 Nbextensions 탭이 추가됩니다. 해당 탭에 들어가서 사용하고자 하는 확장팩을 설정할 수 있습니다. 

여러 개의 확장팩 중에서 주로 사용하게 되는 확장팩은 ExecuteTime과 Table of Contents입니다. ExecuteTime은 각 셀별로 실행 시간을 표출해주며 Table of Contents는 마크다운 문법에 기반해서 목차를 생성해줍니다. 

지금까지 Pandas에 대한 이론적인 배경과 Jupyter Notebook 확장팩에 대해 배워봤습니다. 다음 장에서는 Pandas 실습을 진행해보도록 하겠습니다. 


 이 크고 이제 여기는 의 기본 디폴트로 환경 설정을 한 것들이에요 그래서 그림 크기는 2 rc 파람 이라는 거 난 8옴 애틀란 립 에서 불러온 그 평수 인데 이 환경 편수 이제 이환경 평소 에서 그림 사이즈는 뭐 그 크 가루 크기는 16 그리고 세로 크기 난 8 이제 그림은 또 이미지의 있어 이미 지난 크면 클수록 좋으니까 기본 이미지는 굉장히 작게 그리고 있네요 근데 이제 기본 이미지 사이즈를 크게 하겠다라는 그 환경설정을 한거구요 그리고 5 매 플랜 리베 그림 스타일을 나는 이 파이브 떨이 a 씨라는 스타일을 사용하여 있다 이 스타일을 쓰면 은 이제 파이크 매트한 립 의 기본 스타일이 약간 구린데 이제 이런 그 다른 스타일을 사용하시면 이미지를 컷 그림을 그릴 때 훨씬 더 그 별도의 로 노력을 하지 않고 그림을 버 쉽게 그릴 수 있습니다 그리고 네 이건 안 판다 쓰 옵션인데 한 화면에 보여주는 칼럼 개수를 나는 100개까지 보여주겠다 이제 보통 칼럼 개수가 일정 기수가 늘어나면 점 점 으로 표시가 되는데 이제 나는 데 까지는 그냥 다 보유 그 화면에 보이고 싶다 라고 한거구요 그리고 이제 프리시즌 pc 점원 야 며 소숫점 몇째 자리까지 보여줄 건가 라는 소수점 말에 내 자리까지 막 보겠다 기본적으로는 6자리 여걸 자리까지 그 준데 나는 내 자리까지 만보계 따라가는 환경설정을 한거구요 그리고 모든 그 경고는 그냥 무시 하겠다라는 이제 환경 설정을 했습니다 애크미 이제 데이터는 여기에 그 해외에 사이트에서 다운로드 받으실수 있고 골을 저희가 ef 폴더에 저장 했어요 그래서 이제 노트북에서는 그 터미널 명령어를 직접 실행을 할 수가 있는데 파미 널 명령을 직접 실행 하시려면 여기 앞에 느낌표를 하시고 터미널 명령을 주시면 은 이 주피터 노트북을 나가지 않고 안에서 품 1년 명령을 실행할 수 있습니다 그래서이 ls 는 그 쌓일 목록을 그 열람하는 명령어 인데 지금 이 점 점 1 그 한 단계 위의 상위 볼드 에서 임프 폴더 라는 그 폴더안에 들어있는 빨리 들을 열람을 하는 지급명령을 그래서 거기에 보시면 쌤플 엄 버 스 코 써 미 션 다시 s 위 빨리 잊고 테스트 데이터가 테스 tess 위 트레인 데이터 최혜인 다스 sb 에 저장돼 있는 걸 알 수 있어요 예 그래서 이제 2 그인 프 폴더를 저희 기본적인 데이터 폴더 로지 절하고 최인 그 데이터 파일 테스트 데이터 파일 이런 그 이 파일을 이제 변수를 생성할 해줬어요 파일 경로를 변수로 생성을 해주고 그리고 ep 첫 atop 체험 더 스코 파일은 저희가 그 2d 에 과정을 마치고 생성된 비쳐 를 저장할 달 이름이요 그래서 그 비춰 다시쓰기 빨리 라는 이름으로 데이터 디렉토리 안에 쳐 자라 있다 그래서 그것을 뛰쳐 얹고 쓰고 빨리 라는 변수로 지정할 해주었구요 그리고 쓰이던 은 이제 맨 더미 제 뒤에 그 샘 데이터를 샘플 하는 코드가 있는데 거기서 사용할 그 랜덤 시도로 40 이라는 수업을 사용하겠다 하고 이제 설정을 해주었습니다 그러면 이제 학습 데이터를 노드를 하겠는데요 여기에 최인 파일 그 최인 데이터가 담겨 있는 트레인 다 cs2 바라는 파일을 바로 판다 슬 라 이 브 돼 썼지 구하는 위더스 코스 sdi csd 라는 함수를 통해서 1골 수가 있습니다 이제 7월 배 ex 언더 스크 칼럼 이라는 임프 ru 멘트를 통해서 어떤 칼럼을 내가 인덱스 사용 할 건지 지정을 할 수가 있어요 이거를 지정을 안 해주면 기본적으로 판다 3 에서 새로운 인덱스를 생성 을 하게 됩니다 그런데 이제 이 데이터 파일을 그 7 보신 분들은 아시겠지만 이 데이터 파일의 첫번째 그 칼럼이 바로 id 컬럼 이에요 그게 이제 인덱스 칼럼 이기 때문에 저희는 첫번째 칼럼 이제 영이 첫번째 칼럼이 전형 부터 시작을 하겠 회적 파이썬에서 는 항상 이제 그래서 첫번째 칼럼을 나는 인덱스로 사용을 했다 라고 이제 지정을 해주고 그 투 이렇게 블론 베이터 를 prn 최인희 라는 데이터 프레임 이라는 데이터 프레임 그 변수에 저장을 합니다 그리고 추해 인다 칩 이라고 이제 하면은 이 데이터 프레임의 크기를 저희가 프린트를 할 수가 있어요 그리고 최인 다 패드 라고 하면은 2 그 최인희 라는 데이터 프레임의 첫 극 몇 회 몇 그 행을 보여주게 됩니다 그래서 실행 하면 이렇게 이제 보여줘야 되죠 그래서 그 쉐이 e 프린트 최인 다 쉐비 l 난 값이 바로 이 값이 6대 서이추 애인이라는 데이터가 참 그 3만 2000개의 행위 있고 19 깨에 칼럼이 있음을 확인할 수 있습니다 그 9시 메인 이제 저희가 id 칼럼을 첫번째 칼럼을 그 인덱스로 사용했구요 그리고 여기에 보면 유치 ric 이런 칼럼 들이 쭉 있고 마지막 칼럼이 바로 이제 저희가 예측해야 하는 학습 때 예측해야 하는 그 정답 칼럼이 줘 레이블 칼럼이 바로 킬 x 않은 레이블 칼럼 2 이렇게 있는 것을 알 수 있습니다 이크 에서 헤드 라는 명령어를 통해서 바로 첫 5주 를 이렇게 봤구요 마찬가지로 테일이 라는 명령어를 통해서 마지막 타석 그 줄을 볼 수가 있습니다 그래서 이제 인덱스가 쭉 0부터 시작해서 3199 그래서 총 32만 개의 데이터가 있고 샘플이 있고 이제 마지막 타서 그 줄에 박씨 이렇게 보여지면 알 수 있습니다 그 이제 판 더 스 에서 제공하는 그 함수 중에 디스크 ip 라는 함수를 실행 하면 이 데이터 프레임의 전반적인 5 다음 그 개요를 보여 주게 되요 그래서 예를 들면 이유라는 칼럼이 총 3만 2000개 카운트가 32,000 개이고 금이 그 평균값이 19,850원 스탠드 rtb 에이션 이 이제 1.94 그리고 미니멈 값이 최적 같이 - 10 7.68 그리고 25% 에 해당하는 값이 18 이 쭉쭉 올라가서 최대값이 58 그리고 이게 모든 가치에 대해서 다 이렇게 보여주죠 그래서 대충 데이터가 아이 데이터가 뭐 어떤 음수 값이 참 뭐 큰 음수 값이 있구나 뭐 아니면은 뭐 이 데이터는 다양 수만 양수 깜 만 가지고 있구나 이에 목적은 아 n 기 택배 라는 편수는 양 속감 만 가지고 있구나 뭐 이런 것들을 쉽게 할 수가 있죠 그리고 이제 그 데이터 타입을 본 옆면은 b 타이스 가는 그 in the heel 터에서 이제 데이터 타입을 확인할 수 있어요 그래서 보시면 뉴 아이치 이런 칼럼 들은 그 실수 형 데이터 타입을 가지고 있고 이 에녹 절구 나 n 디텍트 나 클래스 는 전수 형 데이터 타입을 가짐을 확인할 수 있죠 이제 이것도 이외에도 뭐 문자열 데이터 타입 일 수도 있고 아니면 그 날짜 시간 테이터 타입일 수도 있고 근데 지금 이 데이터는 지금 실 수용하고 정수영 피터 타임 많이 있다는 것을 확인할 수 있습니다 그러면 이제 그 저희가 가장 그 관심이 있는 것은 2 종속 변수 클래스 다는 레이블이 좋다 개인 레이블 2 네이버를 저희가 예측을 해야 되는데 이 레이블이 후 어떤 분포가 있는지를 확인하고 싶다 했을 때 이제 단순하게 히스토그램을 그럴 수도 있죠 est 라는 그 함수를 부르며 는 이게 이제 급 억세 를 이용해서 내가 사용하고 싶은 그 칼럼을 지정하고 그 다음에 시각화를 하고자 하면 다 키스 특이 쏘 그림을 그린다고 하면 이 명령을 사용하면 이렇게 히스토그램 군포를 보여줍니다 그래서 0a 깝 영애가 길에 까이 이 값을 가지는 것을 확인할 수 있구요 이제 1회 까 병의 값과 이해 값이 많고 이래 값은 별로 없고 이런 풍토를 가졌구나 라고 확인을 할 수가 있습니다 이제 구체적인 숫자 수치를 확인하고 싶으시면 이 벨류 카운트 라는 그 앞서 소개드린 함수를 터에 다 할 수가 있는데요 그래서 이거를 실행하며 으 예 0이라는 값이 뭐 약 12만 번 그 나왔고 일이다 1 값이 42,700 85번 나왔다 그리고 이라는 값이 55만 7219 번 19 번 나왔다 이걸 우파로 확인을 할 수가 있죠 그리고 이제 쏜 t 인덱스를 중간은 이게 솔티 인덱스를 사용하지 않느냐 이제 이렇게 값이 나오는데 이걸 내가 인덱스 값으로 쏠 쏠 틀을 하고 싶다 그러면은 바로 뒤에 붙여서 폴트 인덱스 라고 하면은 이 게임 이걸 이제 이 출력 값이 시리즈 시리즈 객체가 되는데 이 시리즈에 객체들 인덱스로 썬팅을 정렬을 하게 됩니다 그래서 이제 정렬을 할 때 사용하는 함수 이구요 이 이렇게 좀 속된 수분 패에 대해서 간단하게 확인 해 보았고 그 다음에 이제 국립 변수들 b 차들의 분포를 이제 확인을 할 때도 비슷하게 할 수 있습니다 그래서 예를 들어서 아이라는 칼럼이 있었죠 여기에 본 보시면 이 아이라는 칼럼에 분포를 알고 싶다 그러면 마찬가지로 그 데이터 프레임의 벅스의 아이 들면 아이 라는 칼럼을 선택해서 히스토그램을 그리는데 히스토그램 에 있는 그 1 튜빙 을 그릴 때 2급인 빈 택스 입어 캐 개수를 나는 100개를 사용하겠다는 허구가 그래서 하면은 이제 보시면은 0 각 3 대부분의 0 추위에 대부분의 값이 있는데 이제 그 이쪽 최적 값은 - 25 말 안 25,000 까지 있다는 것을 이제 표 충분 수 있죠 그러면 이제 분포를 내가 그 퍼센트 짐 우포 를 보고 싶다 그럼 에이콘 파일이 라는 함수를 사용할 수가 있어요 그래서 마찬가지로 아이 칼럼을 선택을 해주고 컨텍 에 가는 그 함수를 불러주면 그리고 이제 콘 타액에 가는 함수 뒤에 이 꺼는 뭐냐면 mp 어레인지 00일 하고 0.01 하며 는 0부터 142 예 그 0.01 단계로 쭉 나눔 답들을 이제 패스를 하는 거예요 그래서 일어를 하에 보여드린 야 0부터 0 0.0 의 0.02 0.03 해서 쭉 해서 일 까지 가는 그 총 팩 1개를 1개의 값을 생성 그 생성을 하는거고 그거를 이콘 타일이 라는 함수에 값을 주면 이 각각 값에 대한 퍼센트 지를 보여줍니다 그래서 이 아이 라는 칼럼을 그 값이 적은 수 것부터 최대가 까지 쭉 그 정열을 한 다음에 첫 1% 최저 1% 를 보면 은 그 10 최저 1% 에 해당하는 값이 14.4 5 그 다음에 최저 2% 에 해당 하는 값이 14.8 7 그래서 쭉 해서 그 99% 해랑 값이 20.6 이렇게 분포에 대한 값을 그 이 퀀트 아이리 라는 함수를 통해서 알 수 있구요 의 봄이 이제 최대 최저 값은 굉장히 낮은 데 대부분의 값은 이제 한 14에서 24 이에 부 하고 있음을 알 수가 있죠 자 그러면 이제 그 궁금한 게 아 그러면 은 1% 고 14 인데 도대체 어떤 값들이 얼마나 많은 값들이 이음 수의 값을 탔나 그러면 이제 그것을 확인할 때 이런 문법을 사용할 수가 있어요 그래서 더 이제 라는 이 데이터 프레임의 아 이 칼럼이 0보다 작은 모든 샘플을 불러보고 싶다 라고 하면 이 조건문을 주고 else 그 나는 그 이제 문법을 통해서 실행을 하며 이 trt 최희 라는 데이터 프레임 중에서 아 이 칼럼이 0보다 작은 모든 샘플들을 다 이렇게 보여주게 도 돼서 보면 32만 개의 데이터 중에 4개의 말 이 아이 칼럼이 음수 라는 거죠 그래서 어 나머지는 전부 다 양수 값을 다지는 데 이 4개의 단말 ei 칼럼 이음쇠 값을 갖는다 다른 걸 화해할 수 있구요 그러면 이제 이 아이 칼럼 하고 관련되어 있는 이 데이터 그 알파로 기회 도 언더 스쿠 아이라는 칼럼 인데 이 보면은 뉴 gri 치에 해당하는 그 뒤 레드 유튜브 베드 취 뒤 후에 더할 뒤로 헤드 idol 듯이 이 칼럼 들이 있죠 그러면은 이 칼럼 그 기회에 드 아이라는 칼럼도 이 아이라는 칼럼 하고 분포가 비슷한지 이제 예 마찬가지로 분포를 확인해 볼 수 있겠죠 그래서 마찬가지고 9 doli 라는 칼럼을 선택한 다음에 스타일이라는 함수의 실행 에서 분포를 확인 해 보며 거의 비슷하죠 음수 값이 최적 값이 이긴 한데 그 1% 에서 99% 에 해당하는 값은 전부다 양수한 14에서 24 이 카 아 그래서 이런 차이 이렇게 그 두 칼럼이 비슷하다 라는 걸 확인 할 수 있구요 마찬가지로 기 레드 칼럼이 음수가 되는 닭들을 환해 보며 아 이 칼럼이 음수의 되는 그 갯수 보다는 많죠 그래서 아이 칼럼 형수인 그 값은 4개 밖에 없었는데 매개 샘플 밖에 없었는데 d 레드아이 값이 용서 된 칼럼은 이제 7개가 이렇게 존재함을 확인할 수 있습니다 이제 이런 식으로 내가 어떤 그 데이터 어떤 칼럼에 대해서 좀 더 알아 보고 싶다 할 때 이 급한 다 3 에서 제공하는 그 어떤 조건 문이나 아니면 이런 다 에로 c 이런 걸 통해서 그 해당 않는 샘플을 선택을 할 수가 있어요 어떤 조건을 만족시키는 데이터를 3 그 선택을 해서 이제 그 데이터만 추출해서 보이거나 아니면 어 그 데이터를 데이터만 추출해서 삭제를 하거나 이제 그런거 를 할 때 사용할 수 있습니다 그 이제 파이썬 2 그 데이터 2 da 를 할 때 가장 많이 사용하는게 시각 환대 이제 저희가 이렇게 수치를 하나하나 보면은 화한 와 닿는데 시각화를 하면은 사람들이 패턴을 쉽게 쉽게 그 알아야 될 수가 있거든요 그래서 이제 시각화를 할텐데 보통 시각 화려하게 는 32 만개 이런 데이터를 한꺼번에 시가 꽐라 면은 눈으로 어차피 그 보기에도 그 어렵고 또 그 시각화 그 프로그램들이 보통 데이터 양이 커지면 은 시간이 오래 걸립니다 그래서 이제 보통은 시각화 할 때는 데이터 크기를 줄여서 이제 데이터를 샘플링 해서 시각과 하는게 효율적이 요 그래서 이제 급한 다스 에서는 데이터 프레임의 이 샘플 이라는 함수를 이용해서 쉽게 데이터를 샘플을 할 수 샘플링을 할 수 있어요 그래서 이 경우에는 나는 피터 만개를 샘플러 이따 32만 개의 예 체인 데이터 중에 만개 만 샘플링을 하 있다 근데 이제 샘플링은 웬 더 막의 되잖아요 근데 그게 랜덤 항거를 내가 어느 정도 그 재영 가능하게 하기 위해서 씨드 값을 줄 수가 있는데 그 씨드 값을 앞서 그 이제 선 1 cd 라는 변수를 통해서 cd 값을 고정을 시켜놓고 데이터를 만개를 샘플을 하겠다 라는 이제 명 양력 명령어 에요 그래서 트레인 이라는 데이터 프레임 에서 쌤플 만개 샌프란 것을 최인 언더 쓰고 샘플이 란 평수로 저장하고 이제 그 제가 즐겨 사용하는 함수는 그 데이터 시각화를 할 때 이 일을 할 때 즐겨 10 사용할 함수가 잎의 없이 않은 지 보네 함수 인데 먼저 보여드리면 은 그 뭘 하는지 그 와 탓일 거예요 이앙 3월 하냐면 이 5개 제가 이제 5개의 칼럼을 주고 그 다음에 이 클래스를 저희가 저희의 종속변수의 클래스 라는 칼럼을 가지고 이 5개의 칼럼 의 분포를 이제 상관 관계를 그래프로 나타낸 거에요 그래서 이 x 축 또 유주 eric 칼럼 이고 y 축도 마찬가지 그 다섯개의 칼럼 이에요 그래서 이 댁 앞서는 각각의 칼라 메 이제 분포를 값에 분포를 보여 주는데 이 클래스 값에 따라서 다른 분포를 그 다른 선으로 보여주는 거예요 그래서 파랑 개 클래스 값이 0일 때 여기 보면 그 레이블이 있죠 그 그리고 빨간 선이 클래스 값이 일대 울안 선이 클래스 값이 일대 이유라는 표수가 어떤 분포를 가지는 g 그래서 저희가 예측해야 하는 각시 e 클래스 레이블이 기 때문에 이게 곡선이 그 분포 또 다다르면 다를수 록 이 변수가 이 클래스 라는 변수를 예측하는데 이용하다 라는 것을 한눈에 이제 그 대충 알 수가 있는 거죠 그래서 이렇게 보면 i 0 이라는 클래스가 2일이나 이라는 클래스보다 이 제국은 아기가 쉽게 꾸나 라는것을 이제 알 수가 있는 거죠 이 그 시각 가을 통해서 그리고 이제 또 다음으로 볼 수 있는 게 이유라는 칼럼과 그리고 이제 보시면은 이제 밑에서 꾸는 게 편하니까 유라는 칼럼과 지라는 칼럼이 어떤 그 상관 관계가 있는지를 이 스켈터 플라스터 에서 볼 수가 있죠 그래서 보시면 아대 춘 이렇게 양의 상관관계를 가 지는구나 그런데 이제 양의 상관관계를 가지는 데 그 클래스가 0일 때 파란 점일 때는 약간 차이가 있구나 라는 걸 확인 할 수 있고 쥐 란 뜻이다 지 칼럼 밥도 이제 양이 상관과 이제 대부분 양의 상관관계를 가지고 있죠 그그 이렇게 기욱이 가 그 양수인 그런 그 스켈터 플라이트 확인할수가 있습니다 그래서 이렇게 눈으로 딱 봤을때 그 특이한 점이 있으면 바로 한 놈의 이제 알아채고 그것을 예 코드로 그 구현을 할 수가 있어요 그래서 시각과 가 이 데이터 1위에 이제 중요한 단계입니다 그게 이제 페어플레이 시안은 15 4 페어 플러시 라는 함수를 통해서 예 손쉽게 이런 시각화를 그릴 수 있으면 이제 예 보여드리고 싶었구요 이제 비슷하게 그 다른 칼럼 에 대해서도 이렇게 시각과 를 그 이제 보여드릴 이제 시각과 를 해 보실 수 있습니다 4 보시면은 이제 이거 난 제가 이거 또 한가지 그 제가 말씀드리고 싶은 10 싶은 건데 ems 라는 칼럼이 5개가 있어요 그 유 쥐 rice 한다는 그 어 5개 ms 칼럼이 있는데 보시면 아시겠지만 이 칼럼이 5개가 거의 똑같습니다 그래서 이 유아가 에 ms 유아에 ms 취 가 거의 일치 하죠 마찬가지로 다른 4개 칼럼도 다 일치합니다 이런 경우에는 아이 5개의 칼럼 중에 하나만 있으면 되겠구나 이거를 히어 콸 통해서 한번에 알 수 있죠 그러면 은 그 이 다섯 개 중에 하나만 극히 파고 나머지 4개는 삭제 해 보려 도 모델링하는 데 별 상관이 없겠구나 이런 아이디어를 시각화를 통해서 이제 알 수가 있습니다 4 이제 그런 걸 보여 드렸구요 그리고 또 많이 판다 스에서 많이 사용하는 함수 중 하나가 바로 이 그룹 파이 라는 함수 인데요 이제 그 2그룹 아이는 엇 그 뒤에 그 칼럼 네임을 입력으로 받아서 그 캘럼 어떤 칼럼에 값으로 내가 데이터 프레임을 그룹을 지어서 거기에 어떤 연산을 하겠다 라는 말이 이렇게 해서 10 들어서 최인 굿바이 클래스 하고 뒤에 인 이라는 함수를 실행하면 이 클래스 칼럼 메카 그러니까 2 0 1 2 이 세 가지 값을 지금 가지고 있죠 이게 클래스가 0일 때의 0인 모든 샘플을 하나의 그룹으로 잡고 클래스 값이 1 모든 샘플을 또 하나의 그고 잡고 클래스가 값이 인 모든 샘플을 하나의 그룹으로 작아서 이 3개의 그룹에 대한 평균값을 내가 알고 싶다 그 라는 말이에요 그래서 시행하면 각각의 클래스 2 클래스 0 1 2 에 대해서 이제 유라는 칼럼이 클래스가 0일 때 평균값이 모였나 이 일대 평균값이 뭐에 나이일 때 평균값이 뭐예요 뜨고 이거를 모든 칼럼에 대해서 보여주고 이 보여 주게 되요 굉장히 이자의 판 라스 라이브러리를 사용할 때 유용한 기능 중 하나에요 그래서 어 데이터를 그룹 지을 때 아니면 이렇게 대충 어떤 그 뭐 어떤 그 칼럼을 가지고 그 플럼 에 대한 뭐 평균값 이나 아니면은 뭐 미디엄 갑 이나 이제 여러가지 값들을 계산을 할 때 그 한 줄에 코드로 실행할 수 있는 굉장히 그 격력한 자주 수의 유용한 함수 입니다 그리고 이제 이거를 그림 그래프로 나타내 보고자 하면 이제 뒤에 플러시 라는 판 데쓰 데이터 프레임 뒤에 플러스 를 붙이면 은 왠만한 시각화를 한 번에 할 수가 있어요 그 지금 이 명령이 이 코드는 볼 그 무슨 뜻이 키 냐 면 쉐인 데이터 프레임을 클래스 로 그룹을 지어서 평균값을 관 이제 그러면 이 데이터 프레임이 나오겠죠 이것을 이제 캐피털 티를 하면 이거를 이제 으 체스 포즈 뭐라고 하죠 이거를 이제 행과 열을 반대로 바꾸죠 그래서 클래스를 클래스 값을 이제 열로 같 열로 갖고 2 그 열 을 가까이 칼럼을 행으로 갖고 2 그렇게 이제 변화는 한 다음에 괄 착해 를 그리게 따라 는 그 명령어 에요 그래서 이렇게 보시면은 4 이 각각의 클래스에 대한 평균값이 2ms 그 변수는 6급 칼럼에 경우에는 다 똑같죠 그 다시 한번 ims 그 변수는 5개가 다 필요하지 않구나 4개는 없어도 되겠다 이걸 알 수가 있고 이제 다른 경우에는 앞으 동 그 클래스가 0일 때 평균값이 높으나 이런 그리고 클래스가 이 일대 현금가 p 났구나 이런 것을 한눈에 알 수가 있죠 그래서 이제 이렇게 데이터를 분석하는데 이용한 어 시각과 가 이용하다 그리고 그룹 빨리 함수가 이용하다 이런것을 보여드렸습니다 예 그리고 이제 또 그 다음으로 보여드릴 r 골드 를 기념한 이제 베이터 결합하고 비쳐 변환하고 이제 생성하는 것을 거 들던데 언제 그걸 위해서 테스트 시험 데이터 고 마찬가지로 도 들을 해보겠습니다 그래서 마찬가지로 미드 cs2 함수를 이용해서 테스트 파일을 로드 를 했구요 그리고 이제 다 헤드업 함수를 이용해서 이제 처음 몇 주를 출력을 했습니다 이제 최희 데이터를 로드 한 게 있고 패스 데이터 로드 한 게 있는데 이 두 개를 이제 결합을 시키겠다 라고 할 때 사용하는 함수가 4판 랏셀 컴 캣 컴 케트는 a 세준 말인데 이 컴퓨터 탐스 를 사용하면 은 이것을 이렇게 그 가로나 세로로 이렇게 결합을 할 수 있습니다 그래서 이 엑시스 다는 임프 다이브 만을 통해서 입력 변수를 통해서 이제 어떤 식으로 결합을 할 건지를 정해 주는데요 예를 들면 은 이렇게 위아래로 결합을 하겠다 그 학습 데이트와 체험 데이터를 위아래로 결합을 할 다하며 엑시스 를 0으로 주면 되구요 이거를 그 가로로 결합을 하겠다 옆으로 결합을 하여 있다 그러면은 이제 엑시스 값의 일로 주시면 옆으로 결합을 향이 됩니다 그래서 결합한 그 데이터 페임 을 이제 bf 라는 변수로 할당을 하구요 그러면 이제 이렇게 보시면 페스트 추인 데이터 프레임이 개수가 3만 2000개의 고 테스트 계획 데이터 프레임이 캐릭터 개수가 8정 계양 쓰니까 그거를 결합을 하고 나니까 dfd 타 프레임은 총 데이터 갯수 1 이제 40만개 가득 되었죠 이제 그 칼럼 캐 스 는 여전히 똑같이 19 깨고 그러면은 이제 그 k 를 통해서 마지막 몇 조를 봤는데 마지막 몇주 로 보면 테스트 데이터의 경우에는 이 정답 그 클래스 칼럼이 갑시다 nan 안 딱 씨입니다 미싱 교회의 요 이제 저희가 예측을 해야 되는 각 되기 때문에 이제 값이 주어져 있지 않죠 근데 이제 데이터 처리를 하기 위해서는 2 난 값을 어떠한 다른 값으로 대치 를 해야 하는데 그 퇴치를 할 때 상하가 함수가 바로 이 삘 나 라는 함수를 통해서 이제 이 값들을 배치를 할 수가 있습니다 그래서 이제 이 값을 아영 니라고 배치를 하면 안 되겠죠 - 이제 영은 그 클래스 중 하나이기 때문에 클래스 중 클래스 에 값이 아닌 - 2 왕으로 4개 철을 하면은 그 이제 이 값들이 전부다 그 nan 이 어떤 값들이 - 원으로 그 대체가 됨을 그 확인할 수 있습니다 그래서 삐는 나 라는 함수를 통해서 그 펼치 값을 대체를 할 수 있다 그리고 이제 비쳐 변환하는 것을 잠깐 보여드릴 텐데요 이제 n 옥저 그라는 칼럼 2 이렇게 있는데 이 칼럼의 분포를 보면 은 이렇게 그 x 폰의 셜 딜듀 션 이라고 하죠 이제영 품 명 부분에 값이 제일 많고 값이 커질수록 하기 이제 개수가 줄어듭니다 이런 경우에 이제 가장 많이 하는 변한 기법이 로그를 취하는게 일반 저기요 그래서 이제 그의 목조 그 라는 칼럼에 내가 로그를 취하고 싶다 그럴때 바로 업 플라이 라는 그 함수를 통해서 이 칼럼 전체의 로그를 적용 할 수 있습니다 그래서 이 그 둘은 뭐 를 나타내 냐 면 내가 데이터 프레임의 그 df 라는 데이터 프레임의 에녹 점프 칼럼에 그 로그 넘 파이의 있는 면 파이 에서 제공하는 로그 1p 이거는 뭐 그 원 플러스 라는 함수에 요 그래서 그냥 로그를 취하는 게 아니라 해당 값에 1을 더한 다음에 로 굴을 취하는 항 쓰는데 이게 이제 그 어떤 값이 0이 될 수 있을 때 로그에 영영은 - 부안 되잖아요 그래서 같이 이제 다루기가 어려우니까 1 + 양수 깍 뭐 0을 포함한 양씨 박스를 하면은 - 뭐한데 값이 안 나오기 위해서 이제 로그 원원 쿠어스 보그 해서 넘 파이 의 로그 웜 피라는 할수가 있어요 그래서 이 함수를 이에 뭐 어쩌란 탈 칼럼에 다 적용을 하겠다 그래서 그 값을 채로운 이 새로운 값을 다시 애 목적 란 값으로 배치를 하겠다라는 그 이제 명령 이에요 그래서 실행을 하고 다시 히스토그램을 그리며 는 이제 전에는 최대값이 40 정도 있는데 최대값이 1 3.5 로 낮춰 지역 하는걸 와야 할 수 있죠 어 그래서 이제 이렇게 노 그 어떤 의 그 뿐만 아니라 다른 함수를 적용할 수도 있겠죠 그래서 어떤 함수를 어떤 칼럼의 모든 값에 적용을 하고 싶을때 어플라이 라는 이제 함수를 사용 하실 수 있습니다 또 이제 다른 방법은 그 사치 경산 2 전부다 가능해 업계에서 이제 그 기 비 레드 u 라는 칼럼에서 뒤 그냥 u 라는 칼럼을 뺀 값을 이제 새로운 칼럼으로 저장하여 있다 할 때 이제 새로운 칼럼 이름을 이렇게 혹세 안에 지정해주고 이제 각각의 컬럼에 대해서 사칙연산을 이렇게 하실 수가 있어요 뭐 더하고 빼고 곱하고 나누고 다 할 수 있는데 여기에서 일단 그 빼는 것만 해서 그 피처를 새로운 피쳐 들을 이제 생성한 문 것을 이제 해보았습니다 그래서 이제 의 보시면은 전에는 클래스 한수가 이 클래스 칼럼이 마지막 칼럼이 하는데 이렇게 추가로 그 몇 개 칼럼을 더 추가했어요 이제 행 들간의 그 그 차를 부 해서 새로운 칼럼 칵스 로 지정해 주었습니다 이렇게 이제 새로운 비쳐 를 생성할 수도 있고 피처를 잊어요 이 비쳐 들의 다 그 필요하지 않을 수 있기 때문에 피처를 삭제를 할 건데 그럼 어떤 빛을 삭제를 할 거냐 이제 데이터 분석할 때 어떤 뛰쳐 갔을 뭐 없냐 모델을 학습할 때 그것은 이제 피처 들이 중복되면 은 급히 쳐들어온 쓸 뭐가 없겠죠 모델을 이 새로운 모델을 하셔도 한때 그래서 이제 어떤 피쳐 들이 중복되는 지 확인하기 위해서 그 상관관계를 탕 관 계수를 이제 그 확인 할 텐데요 4 그 데이터 프레임 에서 상관 관계를 창고 1 개수를 확인하기 위해서 쿨 레이 션 ceo 알람이라는 학교를 통해서 그 상관 개수를 확인할 수 있어요 그래서 이제 상관계수를 그 출력을 한 다음에 그것을 바로 이제 약간 스타일을 적용을 해야 겠다 라는 명령 헌데 이제 이 함수를 실행하면 은 이 테이블에 어떤 이렇게 그 스타일 을 적용 했지요 그래서 가장 높은 값이 이런 가장 짙은 색으로 추 그 보여주고 가장 작은 값이 뭐 0.0 관광 양이 이런거나 예 가장 연한 색갈로 보여주고 그러면 이제 딱 눈으로 봤을 때 어떤 각별히 상관계수가 제일 높은 질을 한번에 확인할 수 있겠죠 그래서 예를 들어서 이제 유라는 칼럼 하고 기 레드 유란 칼럼이 상관계수 와 상당히 높다 그리고 쥐라는 칼럼과 dj 드시러 1 칼럼 2 3 개수와 두 달 이런거를 한번에 확인할 수 있죠 그러면은 이제 이형우 에 그 모델 리얼 할 때는 둘 중에 하나만 사용하면 되죠 윤아 기 레드 유만 사용을 하면 되고 이제 둘 다 사용할 필요가 없다 뭐 이런거를 바로 알 수 있습니다 그리고 그 외에도 이 다섯 개의 칼럼이 상당히 비슷한데 이제 앞서 확인한 것 같이 에 msu 부터 msg 까지 의 5개 칼럼은 거의 상관관계에 개수 상관계수가 일이다 거의 동일한 값을 가진다 그러면은 이 5개 값을 다 사용할 필요 없이 4개는 삭제하고 1 만삭 사용해도 되겠죠 그럼 나는 이제 아다는 아 이제 이런 칼럼 들이 새 그 필요 없다는 걸 알았으니까 데이터 프레임 에서 세째날 있다라고 했을 때 좌 b 라는 함수를 사용해서 삭제를 할 수 있습니다 그래서 이제 엑시스 원이라고 하면 이제 칼럼을 내가 삭제를 하고 싶다 라는 것을 그 명시를 하는거구요 인 플레이스 추라고 하면 이 데이터 페인 그 내에서 다른 새로운 변수를 생성하지 않고 이 데이터 프레임 자체를 내가 수정을 하겠다라는 표현이에요 그래서 이 뒤에 프란은 데이트 데이터 프레임의 이럼 칼럼들을 삭제를 하는데 그거를 새로운 변수에 할당하는 게 아니라 2 df 라는 표 수 자체에서 삭제를 하고 삭제한 후에 데이터 프레임 도 2 df 라는 변수에 고대로 쳐 잘하겠다 라고 하는 거구요 그러면은 이제 삭제하기 전에 는 총 서론 하나의 이제 칼럼이 있었죠 근데 이제 9 를 삭제한 후에는 보시면 20개의 칼럼 만 가지고 있음을 확인할 수 있습니다 이제 이렇게 그 데이터 이제 데이터를 분석을 해보고 새로운 변수를 생성을 하고 쓸모없는 이제 편수를 삭제도 하고 해가 지고 이제 그 피쳐 를 생성했습니다 지금까지 왜 이거를 빨로 저장을 해야겠죠 이제 딸로 저장할 때는 이투 csd 있다요 아체 가라 이 csd 파일 이라고 했는데 이게 잠깐 어 우 스 2 강의가 끝난 에 제가 이것도 수정을 하도록 패스입니다 예 근데 이 제트 그 데이터 프레임 fcs class b 라는 함수를 사용하면 이제 딸로 저장할 수가 이제 그래서 예 푸 cs 빨 fcst 하고 빠이 경로를 저자 그 지정을 해주면 이제 이 데이터 저희가 그 만드니 피쳐 피처를 빨로 저자 해야 됩니다 그래서 약간 치아의 걸렸죠 12.5 초가 걸렸고 이제 다시 한번 2 데이터 폴더를 확인해보면 뒤 쳐다 cs2 라는 파일이 생성 패스 멀 가야 할 수 있습니다 그리고 이 파일을 다시 미드 csv 라는 함수를 이용해서 읽어보면 저희가 방금 생성했다 그 처장이 떠 데이터를 읽어올 수 있음을 확인 할 수 있죠 그리고 다시 한번 코 릴레이션 그 플러스를 그려보면 예 마찬가지로 이렇게 그릴 수 있습니다 네 이제 지금까지 그 포터의 이베이 콘 그 단국대 대회에서 사용하는 데이터를 가지고 이제 판다 스 라이브러리를 사용해서 이제 그 데이터 분석을 하는것을 이렇게 데모를 보여드렸는데요 이게 이제 그 보기만 해서는 아마 아직 이제 기존의 판다 수 날 별 을 사용하신 분들은 이제 데모를 보시면 으 나도 이제 이렇게 할 수 있겠다라는 그 어느 정도 감이 오실 텐데 판단 쓰 라이브러리를 한 번도 사용해보지 않으신 분들은 따라 오시는게 약간 힘드셨을 수 있어요 근데 이제 그래도 그 너무 그 좌절하지 마시고 이거를 그 데이터를 계속 분석을 했는데 사용하는 함수가 지금 보시면은 한 열 개 정도의 함수를 반복해서 계속 사용을 하거든요 그렇기 때문에 이 10개 정도의 함수만 익숙해지시면 은 이제 그 두려움 없이 뭐 이제 별다른 어려움 없이 여러 가지의 데이터를 분석할 수 있는데 모두 활용하실 수 있습니다 그래서 어 너무 처음 접하 시드 래도 너무 그 힘 이제 어렵다고 느끼실 더라도 계속 한번 사용 해 보시 이제 이 예제 파일을 그 다운로드 받으셔서 계속 한번 본인이 실행해 보시기 바랍니다 혹시 여기까지 질문 사항이 있으신 거에요 저희가 이제 몇 분 남지 않았는데 이제 수업 내용은 여기까지 고 그 참고자료를 대째 각 위에 몇 개 그 추가를 했어요 그래 여기까지 혹시 질문 그 하실 내용이 있으시면 예 질문해 주시기 바랍니다 4 없으시면 참고자료는 아 그 첫번째 강의에서도 소개해 드렸듯이 이 한비 출판사에서 나온 파이썬 라이브러리를 을 활용한 데이터 분석 e 판인데 일판 하고 이파니 이제 그 사이에 그 변경된 내용이 많아요 그래서 꼭 기판에 보시는 걸 추천해 드리구요 이 책을 보시면 굉장히 자세하게 이제 설명이 되어 있습니다 이게 바로 그 외 스매 k2 파이썬 라이브러리 판다 슬 라 이 브 led 를 만든 그 저자가 그 직접 그 작성한 책이구요 그 외에 이제 캐 글에 보시면 팜파스 간격 아 있어요 그래서 제가 링크를 여기에 거론 왔으니까 이제 케익을 판다 스 관자 나 아니면 판다 셸 라이브러리 공식 홈페이지인 분서 이제 둘 다 영어로 되어있는데 그렇게 어렵지 않게 되자 그래서 4 더 자세한 내용을 확인 하시고 싶으신 분들 2